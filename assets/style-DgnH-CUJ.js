import{lh as z,r as i,li as Y,lj as B,j as e,F as L,lk as $,B as w,d as W,X as T,ll as S,lm as j,ln as U,lo as X,bZ as k,lp as G,hl as J,g4 as K,lq as ee,aO as ne,lr as re}from"./iframe-DYYW65BF.js";import{I as x}from"./Icon-Cgu_ls8j.js";var te=function(n,r){r===void 0&&(r={});var t=z(r),s=i.useRef(void 0);Y(function(){var a=B(n);if(a?.addEventListener){var o=function(l,d){var u=l.getData("text/uri-list"),c=l.getData("custom");if(c&&t.current.onDom){var Q=c;try{Q=JSON.parse(c)}catch{Q=c}t.current.onDom(Q,d);return}if(u&&t.current.onUri){t.current.onUri(u,d);return}if(l.files&&l.files.length&&t.current.onFiles){t.current.onFiles(Array.from(l.files),d);return}l.items&&l.items.length&&t.current.onText&&l.items[0].getAsString(function(h){t.current.onText(h,d)})},p=function(l){var d,u;l.preventDefault(),l.stopPropagation(),s.current=l.target,(u=(d=t.current).onDragEnter)===null||u===void 0||u.call(d,l)},g=function(l){var d,u;l.preventDefault(),(u=(d=t.current).onDragOver)===null||u===void 0||u.call(d,l)},m=function(l){var d,u;l.target===s.current&&((u=(d=t.current).onDragLeave)===null||u===void 0||u.call(d,l))},f=function(l){var d,u;l.preventDefault(),o(l.dataTransfer,l),(u=(d=t.current).onDrop)===null||u===void 0||u.call(d,l)},v=function(l){var d,u;o(l.clipboardData,l),(u=(d=t.current).onPaste)===null||u===void 0||u.call(d,l)};return a.addEventListener("dragenter",p),a.addEventListener("dragover",g),a.addEventListener("dragleave",m),a.addEventListener("drop",f),a.addEventListener("paste",v),function(){a.removeEventListener("dragenter",p),a.removeEventListener("dragover",g),a.removeEventListener("dragleave",m),a.removeEventListener("drop",f),a.removeEventListener("paste",v)}}},[],n)};function ae(n){return n.startsWith("http")||n.startsWith("https")}function b({url:n,isImage:r}){const t=r??L.isImage(n),s=ae(n)?decodeURIComponent(n):n,a=s.split("/").pop()||s;return e.jsx("div",{className:"fea-file-view",children:t?e.jsx($,{width:60,height:60,src:n}):e.jsx("div",{className:"flex h-[60px] w-[250px] items-center rounded bg-01 px-1",children:e.jsx("div",{className:"min-w-0",children:e.jsx(L,{name:a})})})})}function ie({urls:n}){return e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(r=>e.jsx(b,{url:r},r))})}b.__docgenInfo={description:"",methods:[],displayName:"FileView",props:{url:{required:!0,tsType:{name:"string"},description:""},isImage:{required:!1,tsType:{name:"boolean"},description:""}}};ie.__docgenInfo={description:"",methods:[],displayName:"FileViewList",props:{urls:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""}}};const P=n=>i.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"size-18 text-dbx-static-white",...n},i.createElement("path",{d:"M10.6254 20.3752V6.69549L5.47304 11.8478C4.93607 12.3848 4.0647 12.3848 3.52773 11.8478C2.99076 11.3109 2.99076 10.4395 3.52773 9.90252L11.0277 2.40252L11.1322 2.30877C11.6723 1.86801 12.4695 1.89901 12.973 2.40252L20.473 9.90252L20.5668 10.007C21.0075 10.5471 20.9766 11.3443 20.473 11.8478C19.9695 12.3513 19.1723 12.3823 18.6322 11.9416L18.5277 11.8478L13.3754 6.69549V20.3752C13.3754 21.1346 12.7598 21.7502 12.0004 21.7502C11.241 21.7502 10.6254 21.1346 10.6254 20.3752Z",fill:"currentColor"}));function M(n){const{refText:r,loading:t,onSubmit:s,value:a,onChange:o}=n,p=t,g=i.useCallback(async()=>{if(p)return;const m={...a,text:a?.text?.trim()};(m.text||m.files&&m.files.length>0)&&(await Promise.resolve(s?.(m)),o?.({}),r.current?.focus())},[p,a,s,o,r]);return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(w,{shape:"circle",size:"small",type:"primary",icon:e.jsx(x,{component:P}),loading:p,disabled:!a?.text,onClick:g})})}M.__docgenInfo={description:"",methods:[],displayName:"Actions",props:{value:{required:!1,tsType:{name:"MSenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: MSenderValue) => void",signature:{arguments:[{type:{name:"MSenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: MSenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"MSenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 录音开始时回调，如果没权限，则 reject */
  onRecordStart?: () => Promise<void>;
  /** 录音结束时回调, isSend 为 true 则发送，否则取消 */
  onRecordEnd?: (isSend: boolean) => Promise<void>;
}`,signature:{properties:[{key:"onRecordStart",value:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1},description:"录音开始时回调，如果没权限，则 reject"},{key:"onRecordEnd",value:{name:"signature",type:"function",raw:"(isSend: boolean) => Promise<void>",signature:{arguments:[{type:{name:"boolean"},name:"isSend"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1},description:"录音结束时回调, isSend 为 true 则发送，否则取消"}]}},description:"是否允许语音输入"},defaultType:{required:!0,tsType:{name:"union",raw:"'input' | 'record'",elements:[{name:"literal",value:"'input'"},{name:"literal",value:"'record'"}]},description:""},statement:{required:!1,tsType:{name:"union",raw:"string | false",elements:[{name:"string"},{name:"literal",value:"false"}]},description:""},refText:{required:!0,tsType:{name:"RefObject",elements:[{name:"HTMLTextAreaElement"}],raw:"RefObject<HTMLTextAreaElement>"},description:""}}};function C({count:n=4,gap:r=2,color:t="white"}){return e.jsx("div",{className:"flex h-0 gap-[2px]",style:{gap:`${r}px`},children:W(n).map(s=>e.jsx("div",{className:T("h-[4px] w-[2px]",{"bg-white":t==="white","bg-primary":t==="primary"}),style:{animation:`sender-rectangle-${t} infinite 1s ease-in-out ${s*1.5/n%1}s`}},s))})}C.__docgenInfo={description:"",methods:[],displayName:"RecordLoading",props:{count:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"4",computed:!1}},gap:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"2",computed:!1}},color:{required:!1,tsType:{name:"union",raw:"'white' | 'primary'",elements:[{name:"literal",value:"'white'"},{name:"literal",value:"'primary'"}]},description:"",defaultValue:{value:"'white'",computed:!1}}}};const E=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",width:20.70703125,height:20.70703125,viewBox:"0 0 20.70703125 20.70703125",...n},i.createElement("g",null,i.createElement("path",{d:"M4.66015625,7.7204833984375L4.66015625,7.1204833984375Q4.66015625,7.0712376784375,4.6697636088,7.0229382184375Q4.679370968,6.9746387584375,4.698216479,6.9291416384375Q4.717061989,6.8836445484375,4.744421437,6.8426982584375Q4.77178088,6.8017519684375,4.80660285,6.7669299984375Q4.84142482,6.7321080284375,4.88237113,6.7047485854375Q4.9233174,6.6773891374375,4.96881449,6.6585436274375Q5.01431161,6.6396981164375,5.06261107,6.6300907572375Q5.11091053,6.6204833984375,5.16015625,6.6204833984375L5.76015625,6.6204833984375Q5.80940185,6.6204833984375,5.85770135,6.6300907572375Q5.9060007500000005,6.6396981164375,5.95149775,6.6585436274375Q5.9969949499999995,6.6773891374375,6.03794125,6.7047485854375Q6.07888745,6.7321080284375,6.11370955,6.7669299984375Q6.14853145,6.8017519684375,6.17589095,6.8426982784375Q6.20325025,6.8836445484375,6.2220958500000005,6.9291416384375Q6.24094145,6.9746387584375,6.2505488499999995,7.0229382184375Q6.26015615,7.0712376784375,6.26015625,7.1204833984375L6.26015625,7.7204833984375Q6.26015615,7.7697289984375,6.2505488499999995,7.8180284984375Q6.24094145,7.8663278984375005,6.2220958500000005,7.9118248984375Q6.20325025,7.9573220984374995,6.17589095,7.9982683984375Q6.14853145,8.0392145984375,6.11370955,8.0740366984375Q6.07888745,8.1088585984375,6.03794125,8.1362180984375Q5.9969949499999995,8.1635773984375,5.95149795,8.1824229984375Q5.90600085,8.2012685984375,5.85770135,8.2108759984375Q5.80940185,8.2204832984375,5.76015625,8.2204833984375L5.16015625,8.2204833984375Q5.11091053,8.2204832984375,5.06261107,8.2108759984375Q5.01431161,8.2012685984375,4.96881449,8.1824229984375Q4.9233174,8.1635773984375,4.88237111,8.1362180984375Q4.84142482,8.1088585984375,4.80660285,8.0740366984375Q4.77178088,8.0392145984375,4.744421437,7.9982683984375Q4.717061989,7.9573220984374995,4.698216479,7.9118250984375Q4.679370968,7.8663279984375,4.6697636088,7.8180284984375Q4.66015625,7.7697289984375,4.66015625,7.7204833984375ZM4.66015625,10.8207640984375L4.66015625,10.2207641984375Q4.66015625,10.1715182984375,4.6697636088,10.1232187984375Q4.679370968,10.0749189984375,4.698216479,10.0294217984375Q4.717061989,9.9839245984375,4.744421437,9.9429783984375Q4.77178088,9.9020323984375,4.80660285,9.8672103984375Q4.84142482,9.8323883984375,4.88237113,9.805029398437501Q4.9233174,9.7776698984375,4.96881449,9.7588243984375Q5.01431161,9.7399787984375,5.06261107,9.7303714984375Q5.11091053,9.7207641984375,5.16015625,9.7207641984375L5.76015625,9.7207641984375Q5.80940185,9.7207641984375,5.85770135,9.7303714984375Q5.9060007500000005,9.7399787984375,5.95149775,9.7588240984375Q5.9969949499999995,9.7776696984375,6.03794125,9.8050291984375Q6.07888745,9.8323883984375,6.11370955,9.8672103984375Q6.14853145,9.9020323984375,6.17589095,9.9429783984375Q6.20325025,9.9839245984375,6.2220958500000005,10.0294217984375Q6.24094145,10.0749189984375,6.2505488499999995,10.1232184984375Q6.26015615,10.1715182984375,6.26015625,10.2207641984375L6.26015625,10.8207640984375Q6.26015615,10.8700093984375,6.2505488499999995,10.9183086984375Q6.24094145,10.9666079984375,6.2220958500000005,11.0121054984375Q6.20325025,11.0576028984375,6.17589095,11.0985488984375Q6.14853145,11.1394953984375,6.11370955,11.1743173984375Q6.07888745,11.2091388984375,6.03794125,11.2364983984375Q5.9969949499999995,11.263857798437499,5.95149795,11.282702898437499Q5.90600085,11.3015489984375,5.85770135,11.3111562984375Q5.80940185,11.3207635984375,5.76015625,11.3207640984375L5.16015625,11.3207640984375Q5.11091053,11.3207635984375,5.06261107,11.3111562984375Q5.01431161,11.3015489984375,4.96881449,11.282702898437499Q4.9233174,11.263857798437499,4.88237111,11.2364983984375Q4.84142482,11.2091388984375,4.80660285,11.1743173984375Q4.77178088,11.1394953984375,4.744421437,11.0985488984375Q4.717061989,11.0576028984375,4.698216479,11.0121054984375Q4.679370968,10.9666079984375,4.6697636088,10.9183086984375Q4.66015625,10.8700093984375,4.66015625,10.8207640984375ZM7.92285155,7.7204833984375L7.92285155,7.1204833984375Q7.92285155,7.0712376784375,7.93245885,7.0229382184375Q7.9420661500000005,6.9746387584375,7.96091175,6.9291416384375Q7.97975735,6.8836445484375,8.00711655,6.8426982584375Q8.03447585,6.8017519684375,8.06929775,6.7669299984375Q8.10411975,6.7321080284375,8.14506575,6.7047485854375Q8.186012250000001,6.6773891374375,8.23150945,6.6585436274375Q8.27700665,6.6396981164375,8.32530615,6.6300907572375Q8.37360575,6.6204833984375,8.42285155,6.6204833984375L9.022851450000001,6.6204833984375Q9.072096850000001,6.6204833984375,9.120396150000001,6.6300907572375Q9.168695450000001,6.6396981164375,9.21419285,6.6585436274375Q9.25968985,6.6773891374375,9.30063625,6.7047485854375Q9.34158225,6.7321080284375,9.376404749999999,6.7669299984375Q9.41122625,6.8017519684375,9.43858625,6.8426982784375Q9.46594525,6.8836445484375,9.48479085,6.9291416384375Q9.50363635,6.9746387584375,9.51324365,7.0229382184375Q9.522850949999999,7.0712376784375,9.522851450000001,7.1204833984375L9.522851450000001,7.7204833984375Q9.522850949999999,7.7697289984375,9.51324365,7.8180284984375Q9.50363635,7.8663278984375005,9.48479085,7.9118248984375Q9.46594525,7.9573220984374995,9.43858575,7.9982683984375Q9.41122625,8.0392145984375,9.376404749999999,8.0740366984375Q9.34158225,8.1088585984375,9.30063625,8.1362180984375Q9.25968935,8.1635773984375,9.214192350000001,8.1824229984375Q9.168695450000001,8.2012685984375,9.120396150000001,8.2108759984375Q9.072096850000001,8.2204832984375,9.022851450000001,8.2204833984375L8.42285155,8.2204833984375Q8.37360575,8.2204832984375,8.32530615,8.2108759984375Q8.27700665,8.2012685984375,8.23150925,8.1824229984375Q8.186012250000001,8.1635773984375,8.14506605,8.1362180984375Q8.10411975,8.1088585984375,8.06929775,8.0740366984375Q8.03447585,8.0392145984375,8.00711655,7.9982683984375Q7.97975705,7.9573220984374995,7.9609115500000005,7.9118250984375Q7.9420661500000005,7.8663279984375,7.93245885,7.8180284984375Q7.92285155,7.7697289984375,7.92285155,7.7204833984375ZM7.92285155,10.8207640984375L7.92285155,10.2207641984375Q7.92285155,10.1715182984375,7.93245885,10.1232187984375Q7.9420661500000005,10.0749189984375,7.96091175,10.0294217984375Q7.97975735,9.9839245984375,8.00711655,9.9429783984375Q8.03447585,9.9020323984375,8.06929775,9.8672103984375Q8.10411975,9.8323883984375,8.14506575,9.805029398437501Q8.186012250000001,9.7776698984375,8.23150945,9.7588243984375Q8.27700665,9.7399787984375,8.32530615,9.7303714984375Q8.37360575,9.7207641984375,8.42285155,9.7207641984375L9.022851450000001,9.7207641984375Q9.072096850000001,9.7207641984375,9.120396150000001,9.7303714984375Q9.168695450000001,9.7399787984375,9.21419285,9.7588240984375Q9.25968985,9.7776696984375,9.30063625,9.8050291984375Q9.34158225,9.8323883984375,9.376404749999999,9.8672103984375Q9.41122625,9.9020323984375,9.43858625,9.9429783984375Q9.46594525,9.9839245984375,9.48479085,10.0294217984375Q9.50363635,10.0749189984375,9.51324365,10.1232184984375Q9.522850949999999,10.1715182984375,9.522851450000001,10.2207641984375L9.522851450000001,10.8207640984375Q9.522850949999999,10.8700093984375,9.51324365,10.9183086984375Q9.50363635,10.9666079984375,9.48479085,11.0121054984375Q9.46594525,11.0576028984375,9.43858575,11.0985488984375Q9.41122625,11.1394953984375,9.376404749999999,11.1743173984375Q9.34158225,11.2091388984375,9.30063625,11.2364983984375Q9.25968935,11.263857798437499,9.214192350000001,11.282702898437499Q9.168695450000001,11.3015489984375,9.120396150000001,11.3111562984375Q9.072096850000001,11.3207635984375,9.022851450000001,11.3207640984375L8.42285155,11.3207640984375Q8.37360575,11.3207635984375,8.32530615,11.3111562984375Q8.27700665,11.3015489984375,8.23150925,11.282702898437499Q8.186012250000001,11.263857798437499,8.14506605,11.2364983984375Q8.10411975,11.2091388984375,8.06929775,11.1743173984375Q8.03447585,11.1394953984375,8.00711655,11.0985488984375Q7.97975705,11.0576028984375,7.9609115500000005,11.0121054984375Q7.9420661500000005,10.9666079984375,7.93245885,10.9183086984375Q7.92285155,10.8700093984375,7.92285155,10.8207640984375ZM11.18554685,7.7204833984375L11.18554685,7.1204833984375Q11.18554685,7.0712376784375,11.19515415,7.0229382184375Q11.20476155,6.9746387584375,11.22360705,6.9291416384375Q11.24245265,6.8836445484375,11.269811650000001,6.8426982584375Q11.29717115,6.8017519684375,11.331993149999999,6.7669299984375Q11.36681505,6.7321080284375,11.40776155,6.7047485854375Q11.44870755,6.6773891374375,11.49420455,6.6585436274375Q11.539701449999999,6.6396981164375,11.58800125,6.6300907572375Q11.63630105,6.6204833984375,11.68554685,6.6204833984375L12.28554675,6.6204833984375Q12.33479215,6.6204833984375,12.38309195,6.6300907572375Q12.43139075,6.6396981164375,12.47688775,6.6585436274375Q12.52238465,6.6773891374375,12.56333165,6.7047485854375Q12.60427765,6.7321080284375,12.63910005,6.7669299984375Q12.67392155,6.8017519684375,12.70128055,6.8426982784375Q12.72864055,6.8836445484375,12.74748615,6.9291416384375Q12.76633265,6.9746387584375,12.77593995,7.0229382184375Q12.78554725,7.0712376784375,12.78554725,7.1204833984375L12.78554725,7.7204833984375Q12.78554725,7.7697289984375,12.77593995,7.8180284984375Q12.76633265,7.8663278984375005,12.74748615,7.9118248984375Q12.72864055,7.9573220984374995,12.70128155,7.9982683984375Q12.67392155,8.0392145984375,12.63910005,8.0740366984375Q12.60427765,8.1088585984375,12.56333165,8.1362180984375Q12.52238465,8.1635773984375,12.47688775,8.1824229984375Q12.43139075,8.2012685984375,12.38309095,8.2108759984375Q12.33479215,8.2204832984375,12.28554675,8.2204833984375L11.68554685,8.2204833984375Q11.63630105,8.2204832984375,11.58800125,8.2108759984375Q11.539701449999999,8.2012685984375,11.49420455,8.1824229984375Q11.44870755,8.1635773984375,11.407761050000001,8.1362180984375Q11.36681505,8.1088585984375,11.331993149999999,8.0740366984375Q11.29717115,8.0392145984375,11.269811650000001,7.9982683984375Q11.24245215,7.9573220984374995,11.22360655,7.9118250984375Q11.20476155,7.8663279984375,11.19515415,7.8180284984375Q11.18554685,7.7697289984375,11.18554685,7.7204833984375ZM14.44726565,7.7204833984375L14.44726565,7.1204833984375Q14.44726565,7.0712376784375,14.45687295,7.0229382184375Q14.46648025,6.9746387584375,14.48532485,6.9291416384375Q14.50417045,6.8836445484375,14.53153035,6.8426982584375Q14.55888935,6.8017519684375,14.59371185,6.7669299984375Q14.62853435,6.7321080284375,14.66948025,6.7047485854375Q14.71042625,6.6773891374375,14.75592325,6.6585436274375Q14.80142025,6.6396981164375,14.84972025,6.6300907572375Q14.89802025,6.6204833984375,14.94726525,6.6204833984375L15.54726625,6.6204833984375Q15.59651125,6.6204833984375,15.64480925,6.6300907572375Q15.69310825,6.6396981164375,15.73860525,6.6585436274375Q15.78410325,6.6773891374375,15.82505025,6.7047485854375Q15.86599625,6.7321080284375,15.90081925,6.7669299984375Q15.93564025,6.8017519684375,15.96299925,6.8426982784375Q15.99035825,6.8836445484375,16.00920525,6.9291416384375Q16.028049250000002,6.9746387584375,16.037657250000002,7.0229382184375Q16.047265250000002,7.0712376784375,16.04726625,7.1204833984375L16.04726625,7.7204833984375Q16.047265250000002,7.7697289984375,16.037657250000002,7.8180284984375Q16.028049250000002,7.8663278984375005,16.00920525,7.9118248984375Q15.99035825,7.9573220984374995,15.96299925,7.9982683984375Q15.93564025,8.0392145984375,15.90081925,8.0740366984375Q15.86599625,8.1088585984375,15.82504925,8.1362180984375Q15.78410325,8.1635773984375,15.73860725,8.1824229984375Q15.69310925,8.2012685984375,15.64481025,8.2108759984375Q15.59651125,8.2204832984375,15.54726625,8.2204833984375L14.94726525,8.2204833984375Q14.89802025,8.2204832984375,14.84972025,8.2108759984375Q14.80142025,8.2012685984375,14.75592325,8.1824229984375Q14.71042625,8.1635773984375,14.66947925,8.1362180984375Q14.62853435,8.1088585984375,14.59371185,8.0740366984375Q14.55888935,8.0392145984375,14.53153035,7.9982683984375Q14.50417045,7.9573220984374995,14.48532485,7.9118250984375Q14.46648025,7.8663279984375,14.45687295,7.8180284984375Q14.44726565,7.7697289984375,14.44726565,7.7204833984375ZM11.18554685,10.8207640984375L11.18554685,10.2207641984375Q11.18554685,10.1715182984375,11.19515415,10.1232187984375Q11.20476155,10.0749189984375,11.22360705,10.0294217984375Q11.24245265,9.9839245984375,11.269811650000001,9.9429783984375Q11.29717115,9.9020323984375,11.331993149999999,9.8672103984375Q11.36681505,9.8323883984375,11.40776155,9.805029398437501Q11.44870755,9.7776698984375,11.49420455,9.7588243984375Q11.539701449999999,9.7399787984375,11.58800125,9.7303714984375Q11.63630105,9.7207641984375,11.68554685,9.7207641984375L12.28554675,9.7207641984375Q12.33479215,9.7207641984375,12.38309195,9.7303714984375Q12.43139075,9.7399787984375,12.47688775,9.7588240984375Q12.52238465,9.7776696984375,12.56333165,9.8050291984375Q12.60427765,9.8323883984375,12.63910005,9.8672103984375Q12.67392155,9.9020323984375,12.70128055,9.9429783984375Q12.72864055,9.9839245984375,12.74748615,10.0294217984375Q12.76633265,10.0749189984375,12.77593995,10.1232184984375Q12.78554725,10.1715182984375,12.78554725,10.2207641984375L12.78554725,10.8207640984375Q12.78554725,10.8700093984375,12.77593995,10.9183086984375Q12.76633265,10.9666079984375,12.74748615,11.0121054984375Q12.72864055,11.0576028984375,12.70128155,11.0985488984375Q12.67392155,11.1394953984375,12.63910005,11.1743173984375Q12.60427765,11.2091388984375,12.56333165,11.2364983984375Q12.52238465,11.263857798437499,12.47688775,11.282702898437499Q12.43139075,11.3015489984375,12.38309095,11.3111562984375Q12.33479215,11.3207635984375,12.28554675,11.3207640984375L11.68554685,11.3207640984375Q11.63630105,11.3207635984375,11.58800125,11.3111562984375Q11.539701449999999,11.3015489984375,11.49420455,11.282702898437499Q11.44870755,11.263857798437499,11.407761050000001,11.2364983984375Q11.36681505,11.2091388984375,11.331993149999999,11.1743173984375Q11.29717115,11.1394953984375,11.269811650000001,11.0985488984375Q11.24245215,11.0576028984375,11.22360655,11.0121054984375Q11.20476155,10.9666079984375,11.19515415,10.9183086984375Q11.18554685,10.8700093984375,11.18554685,10.8207640984375ZM14.44726565,10.8207640984375L14.44726565,10.2207641984375Q14.44726565,10.1715182984375,14.45687295,10.1232187984375Q14.46648025,10.0749189984375,14.48532485,10.0294217984375Q14.50417045,9.9839245984375,14.53153035,9.9429783984375Q14.55888935,9.9020323984375,14.59371185,9.8672103984375Q14.62853435,9.8323883984375,14.66948025,9.805029398437501Q14.71042625,9.7776698984375,14.75592325,9.7588243984375Q14.80142025,9.7399787984375,14.84972025,9.7303714984375Q14.89802025,9.7207641984375,14.94726525,9.7207641984375L15.54726625,9.7207641984375Q15.59651125,9.7207641984375,15.64480925,9.7303714984375Q15.69310825,9.7399787984375,15.73860525,9.7588240984375Q15.78410325,9.7776696984375,15.82505025,9.8050291984375Q15.86599625,9.8323883984375,15.90081925,9.8672103984375Q15.93564025,9.9020323984375,15.96299925,9.9429783984375Q15.99035825,9.9839245984375,16.00920525,10.0294217984375Q16.028049250000002,10.0749189984375,16.037657250000002,10.1232184984375Q16.047265250000002,10.1715182984375,16.04726625,10.2207641984375L16.04726625,10.8207640984375Q16.047265250000002,10.8700093984375,16.037657250000002,10.9183086984375Q16.028049250000002,10.9666079984375,16.00920525,11.0121054984375Q15.99035825,11.0576028984375,15.96299925,11.0985488984375Q15.93564025,11.1394953984375,15.90081925,11.1743173984375Q15.86599625,11.2091388984375,15.82504925,11.2364983984375Q15.78410325,11.263857798437499,15.73860725,11.282702898437499Q15.69310925,11.3015489984375,15.64481025,11.3111562984375Q15.59651125,11.3207635984375,15.54726625,11.3207640984375L14.94726525,11.3207640984375Q14.89802025,11.3207635984375,14.84972025,11.3111562984375Q14.80142025,11.3015489984375,14.75592325,11.282702898437499Q14.71042625,11.263857798437499,14.66947925,11.2364983984375Q14.62853435,11.2091388984375,14.59371185,11.1743173984375Q14.55888935,11.1394953984375,14.53153035,11.0985488984375Q14.50417045,11.0576028984375,14.48532485,11.0121054984375Q14.46648025,10.9666079984375,14.45687295,10.9183086984375Q14.44726565,10.8700093984375,14.44726565,10.8207640984375Z",fill:"#222222",fillOpacity:1})),i.createElement("rect",{x:6.4091796875,y:13.35443115234375,width:7.887460708618164,height:1.399999976158142,rx:.5,fill:"#222222",fillOpacity:1}),i.createElement("ellipse",{cx:10.353515625,cy:10.353515625,rx:9.228515625,ry:9.228515625,fillOpacity:0,strokeOpacity:1,stroke:"#222222",fill:"none",strokeWidth:1.5,strokeLinecap:"ROUND",strokeLinejoin:"round"})),se=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",width:20.70703125,height:20.70703125,viewBox:"0 0 20.70703125 20.70703125",...n},i.createElement("g",{transform:"matrix(0,1,-1,0,20.70703125,-19.20703125)"},i.createElement("g",{transform:"matrix(0,-1,1,0,0,39.9140625)"},i.createElement("ellipse",{cx:29.560546875,cy:29.560546875,rx:9.228515625,ry:9.228515625,fillOpacity:0,strokeOpacity:1,stroke:"#222222",fill:"none",strokeWidth:1.5,strokeLinecap:"ROUND",strokeLinejoin:"round"})),i.createElement("path",{d:"M26.49383952421875,6.692684515Q25.07902628421875,7.284493835,23.98794138421875,8.363533925L23.98804682421875,8.363640525000001Q23.881225644218752,8.469282625,23.82334768421875,8.607922825Q23.76546979421875,8.746563125,23.76546979421875,8.896799325Q23.76546979421875,8.970653025,23.77987802421875,9.043087725Q23.79428613421875,9.115522425,23.82254874421875,9.183754225Q23.85081136421875,9.251986025,23.89184236421875,9.313393325Q23.93287330421875,9.374800725,23.98509579421875,9.427023125Q24.03731831421875,9.479245625,24.09872549421875,9.520276525Q24.16013264421875,9.561307424999999,24.22836464421875,9.589570325Q24.29659664421875,9.617832925,24.36903134421875,9.632241225Q24.44146604121875,9.646649325,24.51531982421875,9.646649325Q24.66339293421875,9.646649325,24.80035138421875,9.590364025Q24.937309834218752,9.534078825,25.04259282421875,9.429958125L25.04269826421875,9.430064725Q25.92663822421875,8.555882825,27.07268192421875,8.076498525Q28.25945302421875,7.580078125,29.56052212421875,7.580078125Q30.86159232421875,7.580078125,32.04836272421875,8.076498525Q33.19440652421875,8.555882725,34.07834622421875,9.430064725L34.07845212421875,9.429957824999999Q34.183734924218754,9.534078625,34.32069392421875,9.590364025Q34.457652124218754,9.646649325,34.605724824218754,9.646649325Q34.67957882421875,9.646649325,34.75201282421875,9.632241225Q34.82444782421875,9.617832625,34.89267882421875,9.589570025Q34.96091082421875,9.561307424999999,35.02231882421875,9.520276525Q35.083725824218746,9.479245625,35.13594882421875,9.427023125Q35.18817182421875,9.374800725,35.22920182421875,9.313393625Q35.27023282421875,9.251986225,35.29849482421875,9.183754425Q35.32675882421875,9.115522425,35.341166824218746,9.043087925Q35.35557582421875,8.970653025,35.35557582421875,8.896799325Q35.35557582421875,8.746562925,35.29769782421875,8.607922525Q35.239820824218754,8.469282225,35.13299882421875,8.363640325L35.13310382421875,8.363533925Q34.04201892421875,7.284493715,32.62720582421875,6.692684515Q31.16267392421875,6.080078125,29.56052212421875,6.080078125Q27.95837112421875,6.080078125,26.49383952421875,6.692684515Z",fillRule:"evenodd",fill:"#222222",fillOpacity:1}),i.createElement("path",{d:"M30.88091327109375,11.87667225Q31.48886827109375,12.13097655,31.95781417109375,12.59474595L31.95791957109375,12.594639149999999Q32.06320287109375,12.69876005,32.20016097109375,12.75504545Q32.33712007109375,12.81133075,32.48519327109375,12.81133075Q32.55904677109375,12.81133075,32.63148117109375,12.79692245Q32.70391557109375,12.78251435,32.77214767109375,12.75425175Q32.84037967109375,12.72598915,32.901786771093754,12.68495815Q32.96319437109375,12.64392725,33.01541707109375,12.59170475Q33.06763937109375,12.53948225,33.10867027109375,12.47807505Q33.14970107109375,12.41666785,33.17796377109375,12.34843575Q33.20622637109375,12.28020385,33.22063447109375,12.20776915Q33.23504307109375,12.13533445,33.23504357109375,12.06148075Q33.23504397109375,11.91124435,33.17716597109375,11.77260423Q33.11928847109375,11.63396394,33.01246647109375,11.52832204L33.01257177109375,11.52821547Q32.33648017109375,10.8595876407,31.45975537109375,10.49285811Q30.55231717109375,10.11328143,29.56019207109375,10.11328137Q28.56806807109375,10.11328131,27.66062997109375,10.49285814Q26.78390618109375,10.8595873907,26.10781443109375,11.52821541L26.10791987109375,11.52832204Q26.001098691093752,11.63396394,25.94322073109375,11.77260423Q25.88534284109375,11.91124435,25.88534284109375,12.06148075Q25.88534284109375,12.13533445,25.89975107109375,12.20776915Q25.91415918109375,12.28020385,25.94242179109375,12.34843585Q25.97068441109375,12.41666795,26.01171541109375,12.47807505Q26.05274635109375,12.53948225,26.10496884109375,12.59170475Q26.15719136109375,12.64392725,26.21859854109375,12.68495825Q26.28000569109375,12.72598915,26.34823769109375,12.75425175Q26.41646969109375,12.78251435,26.48890439109375,12.79692245Q26.56133908809375,12.81133075,26.63519287109375,12.81133075Q26.78326601109375,12.81133075,26.92022449109375,12.75504565Q27.05718294109375,12.69876025,27.16246593109375,12.59463945L27.16257131109375,12.59474595Q27.63151717109375,12.13097695,28.23947267109375,11.876672150000001Q28.86915017109375,11.61328119,29.56019207109375,11.61328131Q30.25123577109375,11.61328131,30.88091327109375,11.87667225Z",fillRule:"evenodd",fill:"#222222",fillOpacity:1}),i.createElement("path",{d:"M28.2385588909375,14.4939614825C28.1481483279375,14.567035732499999,28.1570268349375,14.6987590825,28.2446259009375,14.7751811125L29.4286651609375,15.8081450125C29.5040001609375,15.8738679125,29.6162943609375,15.8738665125,29.6916277609375,15.8081418125L30.8756027609375,14.7751816525C30.963198460937498,14.6987587225,30.9720709609375,14.5670344825,30.8816618609375,14.4939614525C30.5215592609375,14.2029087725,30.0614510609375,14.0283203125,29.5601104609375,14.0283203125C29.0587695809375,14.0283203125,28.5986614809375,14.2029087725,28.2385588909375,14.4939614825Z",fill:"#222222",fillOpacity:1})));function V(n){const{allowSpeech:r,type:t,setType:s}=n;return r?t==="record"?e.jsx(w,{type:"text",shape:"circle",size:"small",icon:e.jsx(x,{component:E,className:"!text-[24px]"}),onClick:()=>s("input")}):e.jsx(w,{type:"text",shape:"circle",size:"small",icon:e.jsx(x,{component:se,className:"!text-[24px]"}),onClick:()=>s("record")}):null}function F(n){const{allowSpeech:r,setType:t}=n,s=i.useRef(null),a=i.useRef(0),[o,p]=i.useState(!1),g=i.useRef(!1),[m,f]=i.useState(!1),v=i.useCallback(async c=>{c.preventDefault(),await r?.onRecordStart?.();const Q=c.touches[0];a.current=Q.clientY,g.current=!1,f(!1),p(!0)},[r]),l=i.useCallback(c=>{if(c.preventDefault(),!o)return;const Q=c.touches[0];a.current-Q.clientY>50?g.current||(g.current=!0,f(!0)):g.current&&(g.current=!1,f(!1))},[o]),d=i.useCallback(async c=>{if(c.preventDefault(),!!o){try{await r?.onRecordEnd?.(!g.current)}catch(Q){console.error(Q)}p(!1),f(!1),g.current=!1,a.current=0}},[r,o]),u=i.useCallback(async c=>{c.preventDefault(),await r?.onRecordEnd?.(!1),p(!1),f(!1),g.current=!1,a.current=0},[r]);return i.useEffect(()=>{const c=s.current;if(c)return c.addEventListener("touchstart",v,{passive:!1}),c.addEventListener("touchmove",l,{passive:!1}),c.addEventListener("touchend",d,{passive:!1}),c.addEventListener("touchcancel",u,{passive:!1}),()=>{c.removeEventListener("touchstart",v),c.removeEventListener("touchmove",l),c.removeEventListener("touchend",d),c.removeEventListener("touchcancel",u)}},[v,l,d,u]),e.jsxs("div",{className:T("absolute inset-0 flex items-center justify-center rounded-full",{"bg-white":!o,"bg-red-500":o&&m,"bg-primary":o&&!m}),children:[o?e.jsxs(e.Fragment,{children:[e.jsx(C,{count:30,gap:4}),m&&e.jsx("div",{className:"absolute top-0 -mt-[2em] text-red08",children:"松手取消"}),!m&&e.jsx("div",{className:"absolute top-0 -mt-[2em] text-primary",children:"松开发送，上移取消"})]}):e.jsx("div",{children:"按住说话"}),e.jsx("div",{className:"absolute inset-0",ref:s}),!o&&e.jsx(w,{type:"text",shape:"circle",size:"small",icon:e.jsx(x,{component:E,className:"!text-[24px]"}),onClick:()=>{t("input")},className:"absolute left-2"})]})}V.__docgenInfo={description:"",methods:[],displayName:"InputRecordSwitch",props:{value:{required:!1,tsType:{name:"MSenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: MSenderValue) => void",signature:{arguments:[{type:{name:"MSenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: MSenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"MSenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 录音开始时回调，如果没权限，则 reject */
  onRecordStart?: () => Promise<void>;
  /** 录音结束时回调, isSend 为 true 则发送，否则取消 */
  onRecordEnd?: (isSend: boolean) => Promise<void>;
}`,signature:{properties:[{key:"onRecordStart",value:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1},description:"录音开始时回调，如果没权限，则 reject"},{key:"onRecordEnd",value:{name:"signature",type:"function",raw:"(isSend: boolean) => Promise<void>",signature:{arguments:[{type:{name:"boolean"},name:"isSend"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1},description:"录音结束时回调, isSend 为 true 则发送，否则取消"}]}},description:"是否允许语音输入"},defaultType:{required:!0,tsType:{name:"union",raw:"'input' | 'record'",elements:[{name:"literal",value:"'input'"},{name:"literal",value:"'record'"}]},description:""},statement:{required:!1,tsType:{name:"union",raw:"string | false",elements:[{name:"string"},{name:"literal",value:"false"}]},description:""},type:{required:!0,tsType:{name:"union",raw:"'input' | 'record'",elements:[{name:"literal",value:"'input'"},{name:"literal",value:"'record'"}]},description:""},setType:{required:!0,tsType:{name:"signature",type:"function",raw:"(type: 'input' | 'record') => void",signature:{arguments:[{type:{name:"union",raw:"'input' | 'record'",elements:[{name:"literal",value:"'input'"},{name:"literal",value:"'record'"}]},name:"type"}],return:{name:"void"}}},description:""}}};F.__docgenInfo={description:"",methods:[],displayName:"RecordAction",props:{value:{required:!1,tsType:{name:"MSenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: MSenderValue) => void",signature:{arguments:[{type:{name:"MSenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: MSenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"MSenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 录音开始时回调，如果没权限，则 reject */
  onRecordStart?: () => Promise<void>;
  /** 录音结束时回调, isSend 为 true 则发送，否则取消 */
  onRecordEnd?: (isSend: boolean) => Promise<void>;
}`,signature:{properties:[{key:"onRecordStart",value:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1},description:"录音开始时回调，如果没权限，则 reject"},{key:"onRecordEnd",value:{name:"signature",type:"function",raw:"(isSend: boolean) => Promise<void>",signature:{arguments:[{type:{name:"boolean"},name:"isSend"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1},description:"录音结束时回调, isSend 为 true 则发送，否则取消"}]}},description:"是否允许语音输入"},defaultType:{required:!0,tsType:{name:"union",raw:"'input' | 'record'",elements:[{name:"literal",value:"'input'"},{name:"literal",value:"'record'"}]},description:""},statement:{required:!1,tsType:{name:"union",raw:"string | false",elements:[{name:"string"},{name:"literal",value:"false"}]},description:""}}};function oe(n){const{value:r,onChange:t,placeholder:s,refText:a}=n;return e.jsx(j.TextArea,{ref:a,value:r?.text,onChange:o=>{t?.({...r,text:o.target.value})},placeholder:s,autoSize:{minRows:1,maxRows:3},className:"mb-[1px] px-2 py-0",variant:"borderless"})}function le(n){const{t:r}=S();return i.useMemo(()=>({...n,placeholder:n.placeholder??r("@fe-free/ai.sender.describeYourQuestion","描述你的问题"),statement:n.statement??r("@fe-free/ai.sender.aiGeneratedDisclaimer","内容由 AI 生成，无法确保信息的真实准确，仅供参考"),defaultType:n.defaultType??"input"}),[n,r])}function de(n){const r=i.useRef(null),t=le(n),{value:s,statement:a,allowSpeech:o,defaultType:p}=t,[g,m]=i.useState(p),f=i.useRef(null);return e.jsxs("div",{className:"fea-m-sender-wrap",children:[e.jsxs("div",{ref:f,className:T("fea-m-sender relative flex items-end rounded-full border border-01 bg-white p-2"),children:[o&&!s?.text&&e.jsx(V,{...t,type:g,setType:m}),e.jsx("div",{className:"flex flex-1",children:e.jsx(oe,{...t,refText:r})}),e.jsx(M,{...t,refText:r}),g==="record"&&e.jsx(F,{...t,setType:m})]}),a&&e.jsxs("div",{className:"mt-1 text-center text-xs text-04",children:["*",a]})]})}de.__docgenInfo={description:"",methods:[],displayName:"MSender",props:{value:{required:!1,tsType:{name:"MSenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: MSenderValue) => void",signature:{arguments:[{type:{name:"MSenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: MSenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"MSenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 录音开始时回调，如果没权限，则 reject */
  onRecordStart?: () => Promise<void>;
  /** 录音结束时回调, isSend 为 true 则发送，否则取消 */
  onRecordEnd?: (isSend: boolean) => Promise<void>;
}`,signature:{properties:[{key:"onRecordStart",value:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1},description:"录音开始时回调，如果没权限，则 reject"},{key:"onRecordEnd",value:{name:"signature",type:"function",raw:"(isSend: boolean) => Promise<void>",signature:{arguments:[{type:{name:"boolean"},name:"isSend"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1},description:"录音结束时回调, isSend 为 true 则发送，否则取消"}]}},description:"是否允许语音输入"},defaultType:{required:!0,tsType:{name:"union",raw:"'input' | 'record'",elements:[{name:"literal",value:"'input'"},{name:"literal",value:"'record'"}]},description:""},statement:{required:!1,tsType:{name:"union",raw:"string | false",elements:[{name:"string"},{name:"literal",value:"false"}]},description:""}}};const ue=n=>i.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...n},i.createElement("path",{d:"M17.3977 3.9588C15.8361 2.39727 13.3037 2.39727 11.7422 3.9588L5.03365 10.6673C2.60612 13.0952 2.60612 17.0314 5.03365 19.4592C7.46144 21.887 11.3983 21.8875 13.8262 19.4599L20.5348 12.7514C20.8472 12.439 21.3534 12.439 21.6658 12.7514C21.9781 13.0638 21.9782 13.5701 21.6658 13.8825L14.9573 20.591C11.9046 23.6435 6.95518 23.6429 3.90255 20.5903C0.850191 17.5377 0.850191 12.5889 3.90255 9.53624L10.6111 2.82771C12.7975 0.641334 16.3424 0.641334 18.5288 2.82771C20.7149 5.01409 20.7151 8.55906 18.5288 10.7454L11.8699 17.4042C10.5369 18.7372 8.37542 18.7365 7.04241 17.4035C5.70963 16.0705 5.7095 13.9096 7.04241 12.5767L13.7012 5.91785C14.0136 5.60547 14.5199 5.60557 14.8323 5.91785C15.1447 6.23027 15.1447 6.73652 14.8323 7.04894L8.1735 13.7078C7.46543 14.4159 7.46556 15.5642 8.1735 16.2724C8.88167 16.9806 10.03 16.9806 10.7381 16.2724L17.397 9.61358C18.9584 8.05211 18.959 5.52035 17.3977 3.9588Z",fill:"currentColor"}));function N(n){const{value:r,refUpload:t,fileUrls:s,setFileUrls:a,allowUpload:o}=n,{filesMaxCount:p}=o||{},{message:g}=U.useApp(),{t:m}=S(),[f,v]=i.useState(""),[l,d]=i.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(G,{trigger:["click"],placement:"topLeft",menu:{items:[{key:"add-file",label:m("@fe-free/ai.sender.addImageOrFile","添加图片或文件"),icon:e.jsx(x,{component:ue}),onClick:()=>{t.current?.click()}},{key:"add-file-url",label:m("@fe-free/ai.sender.addFileUrl","添加文件URL"),icon:e.jsx(x,{component:K}),onClick:()=>{v(""),d(!0)}}]},children:e.jsx(w,{shape:"circle",icon:e.jsx(x,{component:J,className:"!text-lg"})})}),l&&e.jsx(ee,{title:m("@fe-free/ai.sender.addFileUrl","添加文件URL"),open:!0,onCancel:()=>d(!1),onOk:()=>{if(p&&r?.files&&r.files.length>=p){g.warning(m("@fe-free/ai.sender.exceedMaxUploadCount","超过最大上传数量{count}",{count:p}));return}f.trim()&&a([...s,f]),d(!1)},children:e.jsx(j.TextArea,{placeholder:m("@fe-free/ai.sender.pleaseEnterFileUrl","请输入文件URL"),value:f,onChange:u=>v(u.target.value)})})]})}function A(n){const{allowUpload:r,refUpload:t,fileList:s,setFileList:a,uploadMaxCount:o}=n,{uploadAction:p,filesMaxCount:g}=r||{},{message:m}=U.useApp(),{t:f}=S();return e.jsx(X.Dragger,{action:p,fileList:s,multiple:!0,pastable:!0,maxCount:o?o+1:void 0,onChange:v=>{if(o&&v.fileList.length>o){m.warning(f("@fe-free/ai.sender.exceedMaxUploadCount","超过最大上传数量{count}",{count:g})),a(v.fileList.slice(-o));return}a(v.fileList)},children:e.jsx("div",{ref:t,children:f("@fe-free/ai.sender.dragFileHere","在此处拖放文件")})})}function ce({file:n,onDelete:r}){const t=L.isImage(n.name),s=n.response?.data?.url;return e.jsxs("div",{className:"group relative",children:[t?e.jsx(b,{url:URL.createObjectURL(n.originFileObj),isImage:t}):e.jsx(b,{url:n.name}),!s&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-01/80",children:[(n.percent??0).toFixed(0),"%"]}),e.jsx(k,{className:"absolute right-1 top-1 hidden cursor-pointer rounded-full bg-04 text-white group-hover:block",onClick:r})]})}function me({url:n,onDelete:r}){return e.jsxs("div",{className:"group relative",children:[e.jsx("div",{className:"flex h-[60px] w-[250px] items-center rounded bg-01 px-2",children:e.jsx("div",{className:"line-clamp-2",children:n})}),e.jsx(k,{className:"absolute right-1 top-1 hidden cursor-pointer rounded-full bg-04 text-white group-hover:block",onClick:r})]})}function D(n){const{fileList:r,setFileList:t,fileUrls:s,setFileUrls:a}=n;return e.jsx(e.Fragment,{children:(r&&r.length>0||s&&s.length>0)&&e.jsxs("div",{className:"scrollbar-hide mb-2 flex gap-2 overflow-x-auto",children:[r.map(o=>e.jsx(ce,{file:o,onDelete:()=>{t(r.filter(p=>p.uid!==o.uid))}},o.uid)),s.map(o=>e.jsx(me,{url:o,onDelete:()=>{a(s.filter(p=>p!==o))}},o))]})})}N.__docgenInfo={description:"",methods:[],displayName:"FileAction",props:{value:{required:!1,tsType:{name:"SenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowUpload:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 上传文件的接口地址，约定返回的 {data: {url: string}} */
  uploadAction?: string;
  /** files 最大数量 */
  filesMaxCount?: number;
}`,signature:{properties:[{key:"uploadAction",value:{name:"string",required:!1},description:"上传文件的接口地址，约定返回的 {data: {url: string}}"},{key:"filesMaxCount",value:{name:"number",required:!1},description:"files 最大数量"}]}},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 是否正在录音 */
  recording?: boolean;
  /** 录音状态变化时回调 */
  onRecordingChange?: (recording: boolean) => void;
}`,signature:{properties:[{key:"recording",value:{name:"boolean",required:!1},description:"是否正在录音"},{key:"onRecordingChange",value:{name:"signature",type:"function",raw:"(recording: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"recording"}],return:{name:"void"}},required:!1},description:"录音状态变化时回调"}]}},description:"是否允许语音输入"},refUpload:{required:!0,tsType:{name:"RefObject",elements:[{name:"HTMLDivElement"}],raw:"RefObject<HTMLDivElement>"},description:""},fileUrls:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},setFileUrls:{required:!0,tsType:{name:"signature",type:"function",raw:"(fileUrls: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"fileUrls"}],return:{name:"void"}}},description:""}}};D.__docgenInfo={description:"",methods:[],displayName:"Files",props:{value:{required:!1,tsType:{name:"SenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowUpload:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 上传文件的接口地址，约定返回的 {data: {url: string}} */
  uploadAction?: string;
  /** files 最大数量 */
  filesMaxCount?: number;
}`,signature:{properties:[{key:"uploadAction",value:{name:"string",required:!1},description:"上传文件的接口地址，约定返回的 {data: {url: string}}"},{key:"filesMaxCount",value:{name:"number",required:!1},description:"files 最大数量"}]}},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 是否正在录音 */
  recording?: boolean;
  /** 录音状态变化时回调 */
  onRecordingChange?: (recording: boolean) => void;
}`,signature:{properties:[{key:"recording",value:{name:"boolean",required:!1},description:"是否正在录音"},{key:"onRecordingChange",value:{name:"signature",type:"function",raw:"(recording: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"recording"}],return:{name:"void"}},required:!1},description:"录音状态变化时回调"}]}},description:"是否允许语音输入"},fileList:{required:!0,tsType:{name:"Array",elements:[{name:"UploadFile"}],raw:"UploadFile[]"},description:""},setFileList:{required:!0,tsType:{name:"signature",type:"function",raw:"(fileList: UploadFile[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"UploadFile"}],raw:"UploadFile[]"},name:"fileList"}],return:{name:"void"}}},description:""},fileUrls:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},setFileUrls:{required:!0,tsType:{name:"signature",type:"function",raw:"(fileUrls: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"fileUrls"}],return:{name:"void"}}},description:""}}};A.__docgenInfo={description:"",methods:[],displayName:"FileUpload",props:{value:{required:!1,tsType:{name:"SenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowUpload:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 上传文件的接口地址，约定返回的 {data: {url: string}} */
  uploadAction?: string;
  /** files 最大数量 */
  filesMaxCount?: number;
}`,signature:{properties:[{key:"uploadAction",value:{name:"string",required:!1},description:"上传文件的接口地址，约定返回的 {data: {url: string}}"},{key:"filesMaxCount",value:{name:"number",required:!1},description:"files 最大数量"}]}},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 是否正在录音 */
  recording?: boolean;
  /** 录音状态变化时回调 */
  onRecordingChange?: (recording: boolean) => void;
}`,signature:{properties:[{key:"recording",value:{name:"boolean",required:!1},description:"是否正在录音"},{key:"onRecordingChange",value:{name:"signature",type:"function",raw:"(recording: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"recording"}],return:{name:"void"}},required:!1},description:"录音状态变化时回调"}]}},description:"是否允许语音输入"},refUpload:{required:!0,tsType:{name:"RefObject",elements:[{name:"HTMLDivElement"}],raw:"RefObject<HTMLDivElement>"},description:""},fileList:{required:!0,tsType:{name:"Array",elements:[{name:"UploadFile"}],raw:"UploadFile[]"},description:""},setFileList:{required:!0,tsType:{name:"signature",type:"function",raw:"(fileList: UploadFile[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"UploadFile"}],raw:"UploadFile[]"},name:"fileList"}],return:{name:"void"}}},description:""},uploadMaxCount:{required:!1,tsType:{name:"number"},description:""}}};function _(n){const{allowSpeech:r}=n,{recording:t,onRecordingChange:s}=r||{};return t?e.jsx(w,{type:"text",shape:"circle",onClick:()=>s?.(!1),children:e.jsx(C,{count:4,color:"primary"})}):e.jsx(w,{type:"text",shape:"circle",icon:e.jsx(ne,{className:"!text-lg"}),onClick:()=>s?.(!0)})}_.__docgenInfo={description:"",methods:[],displayName:"RecordAction",props:{value:{required:!1,tsType:{name:"SenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowUpload:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 上传文件的接口地址，约定返回的 {data: {url: string}} */
  uploadAction?: string;
  /** files 最大数量 */
  filesMaxCount?: number;
}`,signature:{properties:[{key:"uploadAction",value:{name:"string",required:!1},description:"上传文件的接口地址，约定返回的 {data: {url: string}}"},{key:"filesMaxCount",value:{name:"number",required:!1},description:"files 最大数量"}]}},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 是否正在录音 */
  recording?: boolean;
  /** 录音状态变化时回调 */
  onRecordingChange?: (recording: boolean) => void;
}`,signature:{properties:[{key:"recording",value:{name:"boolean",required:!1},description:"是否正在录音"},{key:"onRecordingChange",value:{name:"signature",type:"function",raw:"(recording: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"recording"}],return:{name:"void"}},required:!1},description:"录音状态变化时回调"}]}},description:"是否允许语音输入"}}};function O(n){const{refText:r,loading:t,onSubmit:s,value:a,onChange:o,refUpload:p,isUploading:g,setFileList:m,fileUrls:f,setFileUrls:v,allowUpload:l,allowSpeech:d}=n,u=t||g,c=i.useCallback(async()=>{if(u||d?.recording)return;const Q={...a,text:a?.text?.trim()};(Q.text||Q.files&&Q.files.length>0)&&(await Promise.resolve(s?.(Q)),m([]),v([]),o?.({}),r.current?.focus())},[u,d?.recording,a,s,m,v,o,r]);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex flex-1 gap-1",children:l&&e.jsx(N,{...n,refUpload:p,fileUrls:f,setFileUrls:v})}),e.jsx(re,{type:"vertical"}),e.jsxs("div",{className:"flex items-center gap-2",children:[d&&e.jsx(_,{...n}),e.jsx(w,{type:"primary",shape:"circle",icon:e.jsx(x,{component:P,className:"!text-lg"}),loading:u,onClick:c})]})]})}O.__docgenInfo={description:"",methods:[],displayName:"Actions",props:{value:{required:!1,tsType:{name:"SenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowUpload:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 上传文件的接口地址，约定返回的 {data: {url: string}} */
  uploadAction?: string;
  /** files 最大数量 */
  filesMaxCount?: number;
}`,signature:{properties:[{key:"uploadAction",value:{name:"string",required:!1},description:"上传文件的接口地址，约定返回的 {data: {url: string}}"},{key:"filesMaxCount",value:{name:"number",required:!1},description:"files 最大数量"}]}},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 是否正在录音 */
  recording?: boolean;
  /** 录音状态变化时回调 */
  onRecordingChange?: (recording: boolean) => void;
}`,signature:{properties:[{key:"recording",value:{name:"boolean",required:!1},description:"是否正在录音"},{key:"onRecordingChange",value:{name:"signature",type:"function",raw:"(recording: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"recording"}],return:{name:"void"}},required:!1},description:"录音状态变化时回调"}]}},description:"是否允许语音输入"},refText:{required:!0,tsType:{name:"RefObject",elements:[{name:"HTMLTextAreaElement"}],raw:"RefObject<HTMLTextAreaElement>"},description:""},refUpload:{required:!0,tsType:{name:"RefObject",elements:[{name:"HTMLDivElement"}],raw:"RefObject<HTMLDivElement>"},description:""},isUploading:{required:!0,tsType:{name:"boolean"},description:""},fileList:{required:!0,tsType:{name:"Array",elements:[{name:"UploadFile"}],raw:"UploadFile[]"},description:""},setFileList:{required:!0,tsType:{name:"signature",type:"function",raw:"(fileList: UploadFile[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"UploadFile"}],raw:"UploadFile[]"},name:"fileList"}],return:{name:"void"}}},description:""},fileUrls:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},setFileUrls:{required:!0,tsType:{name:"signature",type:"function",raw:"(fileUrls: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"fileUrls"}],return:{name:"void"}}},description:""}}};function pe(n){const{value:r,onChange:t,placeholder:s,refText:a}=n;return e.jsx(j.TextArea,{ref:a,value:r?.text,onChange:o=>{t?.({...r,text:o.target.value})},placeholder:s,autoSize:{minRows:2,maxRows:8},className:"mb-1 px-1 py-0",variant:"borderless"})}function ge(n){const{t:r}=S(),t=i.useMemo(()=>({placeholder:n.placeholder??r("@fe-free/ai.sender.describeYourQuestion","描述你的问题"),...n}),[n,r]),s=i.useRef(null),{value:a,onChange:o,allowUpload:p}=t,{filesMaxCount:g}=p||{},m=i.useRef(null),f=i.useRef(null),[v,l]=i.useState(!1);te(m,{onDragEnter:()=>{l(!0)},onDragLeave:()=>{l(!1)},onDrop:()=>{l(!1)}});const[d,u]=i.useState([]),[c,Q]=i.useState([]),h=i.useCallback(({fileUrls:y,fileList:Z})=>{o?.({...a,files:[...Z.map(H=>H.response?.data?.url)||[],...y]})},[a,o]),R=i.useCallback(y=>{u(y),h({fileUrls:y,fileList:c})},[c,h]),q=i.useCallback(y=>{Q(y),h({fileUrls:d,fileList:y})},[d,h]),I=i.useMemo(()=>c.some(y=>!y.response?.data?.url),[c]);return e.jsxs("div",{className:"fea-sender-wrap",children:[e.jsxs("div",{ref:m,className:T("fea-sender relative flex flex-col rounded-lg border border-01 bg-white p-2",{"fea-sender-drag-hover":v}),children:[e.jsx(D,{...t,fileList:c,setFileList:q,fileUrls:d,setFileUrls:R}),e.jsx("div",{className:"flex",children:e.jsx(pe,{...t,refText:s})}),e.jsx(O,{...t,refText:s,refUpload:f,isUploading:I,fileList:c,setFileList:q,fileUrls:d,setFileUrls:R}),e.jsx(A,{...t,refUpload:f,fileList:c,setFileList:q,uploadMaxCount:g?g-d.length:void 0})]}),e.jsx("div",{className:"mt-1 text-center text-xs text-03",children:r("@fe-free/ai.sender.aiGeneratedDisclaimer","内容由 AI 生成，无法确保信息的真实准确，仅供参考")})]})}ge.__docgenInfo={description:"",methods:[],displayName:"Sender",props:{value:{required:!1,tsType:{name:"SenderValue"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(value?: SenderValue) => void | Promise<void>",signature:{arguments:[{type:{name:"SenderValue"},name:"value"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},allowUpload:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 上传文件的接口地址，约定返回的 {data: {url: string}} */
  uploadAction?: string;
  /** files 最大数量 */
  filesMaxCount?: number;
}`,signature:{properties:[{key:"uploadAction",value:{name:"string",required:!1},description:"上传文件的接口地址，约定返回的 {data: {url: string}}"},{key:"filesMaxCount",value:{name:"number",required:!1},description:"files 最大数量"}]}},description:""},allowSpeech:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** 是否正在录音 */
  recording?: boolean;
  /** 录音状态变化时回调 */
  onRecordingChange?: (recording: boolean) => void;
}`,signature:{properties:[{key:"recording",value:{name:"boolean",required:!1},description:"是否正在录音"},{key:"onRecordingChange",value:{name:"signature",type:"function",raw:"(recording: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"recording"}],return:{name:"void"}},required:!1},description:"录音状态变化时回调"}]}},description:"是否允许语音输入"}}};export{ie as F,de as M,ge as S};
